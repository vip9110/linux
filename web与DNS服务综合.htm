<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:黑体;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:微软雅黑;
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@微软雅黑";}
@font-face
	{font-family:"\@黑体";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:21.0pt;
	line-height:19.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
.MsoChpDefault
	{font-size:10.0pt;
	font-family:"Calibri",sans-serif;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	layout-grid:15.6pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-CN style='word-wrap:break-word;text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>要求：配置基于名称的虚拟主机。公司两个站点：</span><span
lang=EN-US>info.abc.com</span><span style='font-family:宋体'>和</span><span
lang=EN-US>sales.abc.com</span><span style='font-family:宋体'>。</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>公司仅有一台服务器，要求能够通过域名进行访问两个站点。</span></p>

<p class=MsoNormal style='margin-left:0cm;text-indent:0cm'><span lang=EN-US>1. </span><span
style='font-family:宋体'>安装服务：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# yum
install bind&nbsp; -y</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]#
systemctl start named</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# rpm
-qa httpd</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# yum
install httpd -y</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>可能出现的问题：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>/var/run/yum.pid </span><span
style='font-family:宋体'>已被锁定，</span><span lang=EN-US>PID </span><span
style='font-family:宋体'>为</span><span lang=EN-US> 2968 </span><span
style='font-family:宋体'>的另一个程序正在运行。</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>Another app is
currently holding the yum lock; waiting for it to exit...</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp; </span><span
style='font-family:宋体'>另一个应用程序是：</span><span lang=EN-US>PackageKit</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;&nbsp;&nbsp; </span><span
style='font-family:宋体'>内存：</span><span lang=EN-US>127 M RSS </span><span
style='font-family:宋体'>（</span><span lang=EN-US>553 MB VSZ</span><span
style='font-family:宋体'>）</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;&nbsp;&nbsp; </span><span
style='font-family:宋体'>已启动：</span><span lang=EN-US> Tue Dec&nbsp; 1 19:59:53
2020 - 04:56</span><span style='font-family:宋体'>之前</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;&nbsp;&nbsp; </span><span
style='font-family:宋体'>状态</span><span lang=EN-US>&nbsp; </span><span
style='font-family:宋体'>：睡眠中，进程</span><span lang=EN-US>ID</span><span
style='font-family:宋体'>：</span><span lang=EN-US>2968</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>解决办法：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>rm -f /var/run/yum.pid</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>或</span><span
lang=EN-US>&nbsp; kill&nbsp; </span><span style='font-family:宋体'>进程号</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>2.</span><span
style='font-family:宋体'>修改网卡</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# vim
/etc/sysconfig/network-scripts/ifcfg-ens33&nbsp; #</span><span
style='font-family:宋体'>修改网卡</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>主要修改：静态获取</span><span
lang=EN-US>IP</span><span style='font-family:宋体'>地址；配置</span><span lang=EN-US>IP</span><span
style='font-family:宋体'>地址，子网掩码和</span><span lang=EN-US>DNS</span><span
style='font-family:宋体'>服务器地址。</span></p>

<p class=MsoNormal style='text-indent:0cm;line-height:normal'><span lang=EN-US><img
width=442 height=409 id="图片 2" src="web与DNS服务综合.files/image001.jpg"></span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>重启网络：</span><span
lang=EN-US>systemctl restart network</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>3.DNS</span><span
style='font-family:宋体'>服务器配置：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]#
systemctl status named&nbsp;&nbsp; #</span><span style='font-family:宋体'>查看状态</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# systemctl
stop named&nbsp;&nbsp;&nbsp; #</span><span style='font-family:宋体'>停止服务</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# vim
/etc/named.conf&nbsp;&nbsp;&nbsp; #</span><span style='font-family:宋体'>修改主配置文件</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体;
color:blue'>需修改的部分：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>listen-on
port 53 {any; };&nbsp;&nbsp; </span></p>

<p class=MsoNormal style='text-indent:0cm;line-height:normal'><span lang=EN-US
style='color:blue'>Allow-query {any;};&nbsp; </span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>recursion
no;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>dnssec-enable
no;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>dnssec-validation
no;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>zone
&quot;abc.com&quot; IN {</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;&nbsp;&nbsp;&nbsp;
type master;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;&nbsp;&nbsp;&nbsp;
file &quot;abc.com.zone&quot;;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>};</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# vim
/var/named/abc.com.zone&nbsp;&nbsp; #</span><span style='font-family:宋体'>修改区域数据文件</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体;
color:blue'>修改为：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>$TTL
3H</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>@
IN SOA abc.com. admin.abc.com. (</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1 ;Serial</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
604800 ;Rfresh</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400 ;Retry </span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2419200 ;Expire</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
60480 ) ; minimum</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>@
IN&nbsp; NS ns1.abc.com.</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>ns1.abc.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp; A 192.168.189.131</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>info.abc.com.&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp; A&nbsp; 192.168.189.131</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>sales.abc.com.&nbsp;&nbsp;&nbsp;
IN&nbsp; A&nbsp; 192.168.189.131</span></p>

<p class=MsoNormal style='text-indent:0cm;line-height:normal'><span lang=EN-US><img
width=519 height=337 src="web与DNS服务综合.files/image002.jpg"></span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>检查配置文件是否正确：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# named-checkzone
abc.com /var/named/abc.com.zone</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>/var/named/abc.com.zone:10:
ignoring out-of-zone data (www.info.com)</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>/var/named/abc.com.zone:11:
ignoring out-of-zone data (www.sales.com)</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>zone
abc.com/IN: loaded serial 1</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>OK</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]#
named-checkconf -z /etc/named.conf</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>abc.com.zone:10:
ignoring out-of-zone data (www.info.com)</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>abc.com.zone:11:
ignoring out-of-zone data (www.sales.com)</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>zone
abc.com/IN: loaded serial 1</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>zone
localhost.localdomain/IN: loaded serial 0</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>zone
localhost/IN: loaded serial 0</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>zone
1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa/IN:
loaded serial 0</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>zone
1.0.0.127.in-addr.arpa/IN: loaded serial 0</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>zone
0.in-addr.arpa/IN: loaded serial 0</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]#
systemctl status named</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>●</span><span
lang=EN-US> named.service - Berkeley Internet Name Domain (DNS)</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;&nbsp;
Loaded: loaded (/usr/lib/systemd/system/named.service; disabled; vendor preset:
disabled)</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;&nbsp;
Active: <span style='color:#00B050'>active (running)</span> since </span><span
style='font-family:宋体'>二</span><span lang=EN-US> 2020-12-01 20:56:11 CST; 8s
ago</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>检查</span><span
lang=EN-US>DNS</span><span style='font-family:宋体'>服务器配置是否正确：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www
~]nslookup&nbsp; info.abc.com&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #</span><span
style='font-family:宋体'>看是否能够解析出</span><span lang=EN-US>IP</span><span
style='font-family:宋体'>地址</span></p>

<p class=MsoNormal style='text-indent:0cm;line-height:normal'><span lang=EN-US><img
width=442 height=122 id="图片 1" src="web与DNS服务综合.files/image003.jpg"></span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>可能遇到的问题：如果出现服务器无法到达</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>解决办法：检查一下网卡配置文件是否配置正确；</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>检查</span><span
lang=EN-US>/etc/reslove.conf</span><span style='font-family:宋体'>这个文件中，是否有</span><span
lang=EN-US>nameserver 192.168.189.131</span><span style='font-family:宋体'>这一行，如果没有，添加这一行进去。</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>或者</span><span
lang=EN-US>systemctl start NetWorkManager</span><span style='font-family:宋体'>之后再添加。</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>4.Web</span><span
style='font-family:宋体'>服务器的配置（基于域名的虚拟主机配置）</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# mkdir
/var/www/info&nbsp;&nbsp; #</span><span style='font-family:宋体'>创建主目录</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# mkdir
/var/www/sales&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #</span><span style='font-family:
宋体'>创建主目录</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# vim
/var/www/sales/index.html&nbsp; #</span><span style='font-family:宋体'>创建主页文件</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体;
color:#2F5496'>输入如下内容：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>This
is sales page.</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]#
vim&nbsp; /var/www/info/index.html&nbsp;&nbsp; #</span><span style='font-family:
宋体'>创建主页文件</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体;
color:#2F5496'>输入如下内容：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>This
is info page.</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]# vim
/etc/httpd/conf/httpd.conf&nbsp;&nbsp; #</span><span style='font-family:宋体'>修改配置文件，增加基于如下部分：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&lt;VirtualHost
*:80&gt;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;&nbsp;&nbsp;
DocumentRoot /var/www/info</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;&nbsp;&nbsp;
ServerName info.abc.com</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&lt;/VirtualHost&gt;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&lt;VirtualHost
*:80&gt;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;&nbsp;&nbsp;
DocumentRoot /var/www/sales</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&nbsp;&nbsp;&nbsp;
ServerName sales.abc.com</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:blue'>&lt;/VirtualHost&gt;</span></p>

<p class=MsoNormal style='text-indent:0cm;line-height:normal'><span lang=EN-US
style='color:blue'><img width=459 height=206 id="图片 3"
src="web与DNS服务综合.files/image004.jpg"></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www ~]#
apachectl configtest&nbsp;&nbsp;&nbsp;&nbsp; #</span><span style='font-family:
宋体'>检查配置文件是否存在语法错误</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>AH00112:
Warning: DocumentRoot [/www/examplecom] does not exist</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>AH00112:
Warning: DocumentRoot [/www/redhatcom] does not exist</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:#C00000'>Syntax
OK</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>检查服务是否正确，两个站点的主页是否能够访问：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@localhost ~]#
systemctl start httpd</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>然后在火狐浏览器地址栏输入域名进行访问测试</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='font-family:宋体'>或者在命令行输入：</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www
~]#firefox info.abc.com</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>[root@www
~]#firefox sales.abc.com</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

</div>

</body>

</html>
